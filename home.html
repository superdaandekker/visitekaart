<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Digitale Kaart – Welkom</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="site-header">
    <div class="nav">
      <a class="site-title" href="home.html">Digitale Kaart</a>
      <nav class="site-nav" aria-label="Hoofdnavigatie">
        <a href="dashboard.html">Dashboard</a>
        <a href="index.html" data-auth-link>Mijn kaart</a>
      </nav>
    </div>
  </header>

  <main class="full-height">
    <section class="card auth-card" aria-labelledby="authTitle">
      <header class="auth-header">
        <h1 id="authTitle">Welkom bij Digitale Kaart</h1>
        <p class="lead">Maak gratis je kaart in 1 minuut.</p>
      </header>

      <div class="tablist" role="tablist" aria-label="Authenticatie">
        <button type="button" class="tab active" role="tab" aria-selected="true" aria-controls="loginPanel" id="tabLogin" data-target="loginPanel">Inloggen</button>
        <button type="button" class="tab" role="tab" aria-selected="false" aria-controls="registerPanel" id="tabRegister" data-target="registerPanel">Account aanmaken</button>
      </div>

      <div class="stack">
        <form id="loginForm" class="auth-form" role="tabpanel" aria-labelledby="tabLogin" data-panel="loginPanel" novalidate>
          <div>
            <label for="loginEmail">E-mailadres</label>
            <input id="loginEmail" name="email" type="email" required autocomplete="email" placeholder="jij@voorbeeld.nl" />
          </div>
          <div>
            <label for="loginPassword">Wachtwoord</label>
            <input id="loginPassword" name="password" type="password" minlength="6" autocomplete="current-password" placeholder="••••••" />
          </div>
          <button type="submit" class="btn">Inloggen</button>
          <p class="switch muted">Nog geen account? <a href="#" data-switch="registerPanel">Registreer gratis</a></p>
        </form>

        <form id="registerForm" class="auth-form" role="tabpanel" aria-labelledby="tabRegister" data-panel="registerPanel" hidden novalidate>
          <div>
            <label for="registerEmail">E-mailadres</label>
            <input id="registerEmail" name="email" type="email" required autocomplete="email" placeholder="jij@voorbeeld.nl" />
          </div>
          <div>
            <label for="registerPassword">Wachtwoord</label>
            <input id="registerPassword" name="password" type="password" minlength="6" required autocomplete="new-password" placeholder="Minimaal 6 tekens" />
          </div>
          <button type="submit" class="btn">Account aanmaken</button>
          <p class="switch muted">Heb je al een account? <a href="#" data-switch="loginPanel">Inloggen</a></p>
        </form>
      </div>

      <p id="authError" class="error" role="status" aria-live="polite"></p>
      <p class="disclaimer">Demo-login zonder backend.</p>
    </section>
  </main>

  <script>
    const tabButtons = Array.from(document.querySelectorAll('.tablist [role="tab"]'));
    const panels = Array.from(document.querySelectorAll('[data-panel]'));
    const errorEl = document.getElementById('authError');

    function activatePanel(panelId) {
      tabButtons.forEach((btn) => {
        const isActive = btn.dataset.target === panelId;
        btn.classList.toggle('active', isActive);
        btn.setAttribute('aria-selected', isActive ? 'true' : 'false');
        btn.setAttribute('tabindex', isActive ? '0' : '-1');
      });

      panels.forEach((panel) => {
        const isActive = panel.dataset.panel === panelId;
        panel.hidden = !isActive;
      });

      errorEl.textContent = '';

      const focusTarget = panelId === 'loginPanel'
        ? document.getElementById('loginEmail')
        : document.getElementById('registerEmail');
      window.requestAnimationFrame(() => focusTarget.focus());
    }

    tabButtons.forEach((btn) => {
      btn.addEventListener('click', () => {
        activatePanel(btn.dataset.target);
      });
    });

    document.querySelectorAll('[data-switch]').forEach((link) => {
      link.addEventListener('click', (event) => {
        event.preventDefault();
        const target = link.getAttribute('data-switch');
        if (target) {
          activatePanel(target);
        }
      });
    });

    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');

    loginForm.addEventListener('submit', (event) => {
      event.preventDefault();
      errorEl.textContent = '';

      const emailInput = loginForm.elements.email;
      const email = emailInput.value.trim();

      if (!email) {
        errorEl.textContent = 'Vul je e-mailadres in.';
        emailInput.focus();
        return;
      }

      if (!emailInput.checkValidity()) {
        errorEl.textContent = 'Vul een geldig e-mailadres in.';
        emailInput.focus();
        return;
      }

      localStorage.setItem('user:email', email);
      window.location.href = 'index.html';
    });

    registerForm.addEventListener('submit', (event) => {
      event.preventDefault();
      errorEl.textContent = '';

      const emailInput = registerForm.elements.email;
      const passwordInput = registerForm.elements.password;
      const email = emailInput.value.trim();
      const password = passwordInput.value;

      if (!email) {
        errorEl.textContent = 'Vul een geldig e-mailadres in.';
        emailInput.focus();
        return;
      }

      if (!emailInput.checkValidity()) {
        errorEl.textContent = emailInput.validationMessage || 'Vul een geldig e-mailadres in.';
        emailInput.focus();
        return;
      }

      if (password.length < 6) {
        errorEl.textContent = 'Kies een wachtwoord van minimaal 6 tekens.';
        passwordInput.focus();
        return;
      }

      localStorage.setItem('user:email', email);
      window.location.href = 'index.html';
    });

    activatePanel('loginPanel');

    const authLink = document.querySelector('[data-auth-link]');
    if (authLink) {
      const loggedIn = Boolean(localStorage.getItem('user:email'));
      authLink.setAttribute('href', loggedIn ? 'card.html' : 'index.html');
    }
  </script>
</body>
</html>
